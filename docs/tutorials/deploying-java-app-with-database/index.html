<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.ff31de0ff">
<link rel="alternate" type="application/rss+xml" href="/ododocs250/blog/rss.xml" title="odo Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/ododocs250/blog/atom.xml" title="odo Blog Atom Feed">
<link rel="search" type="application/opensearchdescription+xml" title="odo" href="/ododocs250/opensearch.xml">
<link rel="preconnect" href="https://cdn.segment.io">
<script>!function(){var e=window.analytics=window.analytics||[];if(!e.initialize)if(e.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{e.invoked=!0,e.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","debug","page","once","off","on","addSourceMiddleware","addIntegrationMiddleware","setAnonymousId","addDestinationMiddleware"],e.factory=function(t){return function(){var a=Array.prototype.slice.call(arguments);return a.unshift(t),e.push(a),e}};for(var t=0;t<e.methods.length;t++){var a=e.methods[t];e[a]=e.factory(a)}e.load=function(t,a){var n=document.createElement("script");n.type="text/javascript",n.async=!0,n.src="https://cdn.segment.com/analytics.js/v1/"+t+"/analytics.min.js";var i=document.getElementsByTagName("script")[0];i.parentNode.insertBefore(n,i),e._loadOptions=a},e._writeKey="seYXMF0tyHs5WcPsaNXtSEmQk3FqzTz0",e.SNIPPET_VERSION="4.15.3",e.load("seYXMF0tyHs5WcPsaNXtSEmQk3FqzTz0"),e.page({},{context:{ip:"0.0.0.0"}})}}()</script><title data-react-helmet="true">Deploying a Java Open Liberty application with PostgreSQL | odo</title><meta data-react-helmet="true" property="og:url" content="https://odo.dev/ododocs250/docs/tutorials/deploying-java-app-with-database"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Deploying a Java Open Liberty application with PostgreSQL | odo"><meta data-react-helmet="true" name="description" content="This tutorial illustrates deploying a Java Open Liberty application with odo and linking it to an in-cluster PostgreSQL service in a minikube environment."><meta data-react-helmet="true" property="og:description" content="This tutorial illustrates deploying a Java Open Liberty application with odo and linking it to an in-cluster PostgreSQL service in a minikube environment."><link data-react-helmet="true" rel="shortcut icon" href="/ododocs250/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://odo.dev/ododocs250/docs/tutorials/deploying-java-app-with-database"><link data-react-helmet="true" rel="alternate" href="https://odo.dev/ododocs250/docs/tutorials/deploying-java-app-with-database" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://odo.dev/ododocs250/docs/tutorials/deploying-java-app-with-database" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/ododocs250/assets/css/styles.2d9597fc.css">
<link rel="preload" href="/ododocs250/assets/js/runtime~main.bfc83875.js" as="script">
<link rel="preload" href="/ododocs250/assets/js/main.0e928838.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/ododocs250/"><strong class="navbar__title">odo</strong></a><a class="navbar__item navbar__link navbar__link--active" href="/ododocs250/docs/intro">Docs</a><a class="navbar__item navbar__link" href="/ododocs250/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/redhat-developer/odo" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--disabled" role="button" tabindex="-1"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/ododocs250/"><strong class="navbar__title">odo</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link navbar__link--active" href="/ododocs250/docs/intro">Docs</a></li><li class="menu__list-item"><a class="menu__link" href="/ododocs250/blog">Blog</a></li><li class="menu__list-item"><a href="https://github.com/redhat-developer/odo" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><div class="docSidebarContainer_3Kbt" role="complementary"><div class="sidebar_15mo"><div class="menu menu--responsive thin-scrollbar menu_Bmed"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/ododocs250/docs/intro">Introduction</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Getting Started</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ododocs250/docs/getting-started/features">Features provided by odo</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ododocs250/docs/getting-started/basics">odo concepts</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ododocs250/docs/getting-started/quickstart">Quickstart</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Cluster Setup</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ododocs250/docs/getting-started/cluster-setup/kubernetes">Setting up a Kubernetes cluster</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ododocs250/docs/getting-started/cluster-setup/openshift">Setup an OpenShift cluster</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ododocs250/docs/getting-started/installation">Installation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ododocs250/docs/getting-started/configure">Configuring odo global settings</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Using odo</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ododocs250/docs/using-odo/create-component">Creating components</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ododocs250/docs/using-odo/create-url">Create URL</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Command Reference</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ododocs250/docs/command-reference/build-images">odo build-images</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ododocs250/docs/command-reference/catalog">odo catalog</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ododocs250/docs/command-reference/delete">odo delete</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ododocs250/docs/command-reference/create">odo create</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ododocs250/docs/command-reference/deploy">odo deploy</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ododocs250/docs/command-reference/link">odo link</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ododocs250/docs/command-reference/registry">odo registry</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ododocs250/docs/command-reference/service">odo service</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ododocs250/docs/command-reference/storage">odo storage</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ododocs250/docs/command-reference/flags">Common Flags</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ododocs250/docs/command-reference/json-output">JSON Output</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Tutorials</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/ododocs250/docs/tutorials/deploying-java-app-with-database">Deploying a Java Open Liberty application with PostgreSQL</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/ododocs250/docs/tutorials/create-k8s-resources">Creating Kubernetes resources using odo</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/ododocs250/docs/tutorials/deploying-a-devfile-using-odo-on-IBM-Z-and-Power">Using odo on IBM-Z and Power</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/ododocs250/docs/tutorials/using-devfile-odo.dev.push.path-attribute">Using the odo.dev.push.path related attribute</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/ododocs250/docs/tutorials/using-devfile-lifecycle-events">Using devfile lifecycle events</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/ododocs250/docs/tutorials/debugging-using-devfile">Debugging using devfile</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Architecture</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ododocs250/docs/architecture/secure-registry">Secure Registry</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/ododocs250/docs/contribution">Contributing to odo</a></li></ul></div></div></div><main class="docMainContainer_3ufF"><div class="container padding-vert--lg docItemWrapper_3FMP"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><header><h1 class="docTitle_3a4h">Deploying a Java Open Liberty application with PostgreSQL</h1></header><div class="markdown"><p>This tutorial illustrates deploying a <a href="https://openliberty.io/" target="_blank" rel="noopener noreferrer">Java Open Liberty</a> application with odo and linking it to an in-cluster PostgreSQL service in a minikube environment.</p><p>There are two roles in this example:</p><ol><li>Cluster Admin - Prepare the cluster by installing the required Operators on the cluster.</li><li>Application Developer - Imports a Java application, creates a Database instance, and connect the application to the Database instance.</li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="cluster-admin"></a>Cluster admin<a class="hash-link" href="#cluster-admin" title="Direct link to heading">#</a></h2><hr><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="prerequisites"></a>Prerequisites<a class="hash-link" href="#prerequisites" title="Direct link to heading">#</a></h3><ul><li>This section assumes that you have installed <a href="/ododocs250/docs/getting-started/cluster-setup/kubernetes">minikube and configured it</a>.</li></ul><hr><p>We will be using Operators in this guide. An Operator helps in deploying the instances of a given service, for example PostgreSQL, MySQL, Redis.</p><p>Furthermore, these Operators are &quot;bind-able&quot;. Meaning, if they expose information necessary to connect to them, odo can help connect your component to their instances.</p><p>See the <a href="/ododocs250/docs/getting-started/cluster-setup/kubernetes">Operator installation guide</a> to install and configure an Operator on a minikube cluster.</p><p>The cluster admin must install two Operators into the cluster:</p><ol><li>PostgreSQL Operator</li><li>Service Binding Operator</li></ol><p>We will use <a href="https://operatorhub.io/operator/postgresql-operator-dev4devs-com" target="_blank" rel="noopener noreferrer">Dev4Devs PostgreSQL Operator</a> found on the <a href="https://operatorhub.io" target="_blank" rel="noopener noreferrer">OperatorHub</a> to demonstrate a sample use case. This Operator will be installed in <code>my-postgresql-operator-dev4devs-com</code> namespace by default, if you want to use another namespace, make sure that you add your namespace to <code>.spec.targetNamespaces</code> list in the definition file before installing it. </p><details><summary>In case of IBM Z &amp; Power, please see below part to install PostgreSQL Operator</summary><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="steps-to-install-dev4devs-postgresql-operator-on-ibm-z-and-power"></a>Steps to install Dev4Devs PostgreSQL Operator on IBM Z and Power<a class="hash-link" href="#steps-to-install-dev4devs-postgresql-operator-on-ibm-z-and-power" title="Direct link to heading">#</a></h4><p>Note: Since operator <a href="https://operatorhub.io/operator/postgresql-operator-dev4devs-com" target="_blank" rel="noopener noreferrer">Dev4Devs PostgreSQL Operator</a> is only supported on x86, this section will use operator-registry image and PostgreSQL Operator image which are published on <code>quay.io/ibm</code> by default. For Z, use <a href="https://quay.io/repository/ibm/operator-registry-s390x" target="_blank" rel="noopener noreferrer">operator-registry-s390x image</a> and <a href="https://quay.io/repository/ibm/postgresql-operator-s390x" target="_blank" rel="noopener noreferrer">postgresql-operator-s390x image</a>. For Power, use <a href="https://quay.io/repository/ibm/operator-registry-ppc64le" target="_blank" rel="noopener noreferrer">operator-registry-ppc64le image</a> and <a href="https://quay.io/repository/ibm/postgresql-operator-ppc64le" target="_blank" rel="noopener noreferrer">postgresql-operator-ppc64le image</a>.</p><ol><li>Create custom CatalogSource</li></ol><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">oc apply -f https://raw.githubusercontent.com/redhat-developer/odo/main/website/manifests/catalog-source-</span><span class="token variable" style="color:#36acaa">$(</span><span class="token variable function" style="color:#d73a49">uname</span><span class="token variable" style="color:#36acaa"> -m</span><span class="token variable" style="color:#36acaa">)</span><span class="token plain">.yaml</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><ol start="2"><li>Install PostgreSQL Operator from custom CatalogSource</li></ol><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">oc create -f https://raw.githubusercontent.com/redhat-developer/odo/main/website/manifests/postgresql-operator-dev4devs-com-IBM-Z-P.yaml</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></details><p><strong>Note</strong>: We will use the <code>my-postgresql-operator-dev4devs-com</code> namespace for this guide.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="application-developer"></a>Application Developer<a class="hash-link" href="#application-developer" title="Direct link to heading">#</a></h2><hr><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="prerequisites-1"></a>Prerequisites<a class="hash-link" href="#prerequisites-1" title="Direct link to heading">#</a></h3><p>This section assumes that you have <a href="/ododocs250/docs/getting-started/installation">installed <code>odo</code></a>.</p><hr><p>Since the PostgreSQL Operator installed in above step is available only in <code>my-postgresql-operator-dev4devs-com</code> namespace, ensure that odo uses this namespace to perform any tasks:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">odo project </span><span class="token builtin class-name">set</span><span class="token plain"> my-postgresql-operator-dev4devs-com</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>If you installed the Operator in a different namespace, ensure that odo uses it to perform any tasks:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">odo project </span><span class="token builtin class-name">set</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">your-namespace</span><span class="token operator" style="color:#393A34">&gt;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="importing-the-jpa-microservice"></a>Importing the JPA MicroService<a class="hash-link" href="#importing-the-jpa-microservice" title="Direct link to heading">#</a></h3><p>In this example we will use odo to manage a sample <a href="https://github.com/OpenLiberty/application-stack-samples.git" target="_blank" rel="noopener noreferrer">Java JPA MicroService application</a>.</p><ol><li><p>Clone the sample application to your system:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">git</span><span class="token plain"> clone https://github.com/OpenLiberty/application-stack-samples.git</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></li><li><p>Go to the sample JPA app directory:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token builtin class-name">cd</span><span class="token plain"> ./application-stack-samples/jpa</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></li><li><p>Initialize the application:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">odo create java-openliberty mysboproj</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p><code>java-openliberty</code> is the type of your application and <code>mysboproj</code> is the name of your application.</p></li><li><p>Deploy the application to the cluster:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">odo push --show-log</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p><strong>Troubleshooting</strong>:
The Open Liberty image used by this application is relatively large(~850 MB), and depending on your internet connection, it might fail to download within the BuildTimeout set by odo; default timeout is 300 seconds.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">$ odo push   </span></div><div class="token-line" style="color:#393A34"><span class="token plain">Validation</span></div><div class="token-line" style="color:#393A34"><span class="token plain">âœ“  Validating the devfile </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">45508ns</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Updating services</span></div><div class="token-line" style="color:#393A34"><span class="token plain">âœ“  Services and Links are </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">sync</span><span class="token plain"> with the cluster, no changes are required</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Creating Kubernetes resources </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> component mysboproj</span></div><div class="token-line" style="color:#393A34"><span class="token plain">âœ—  Waiting </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> component to start </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">5m</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">âœ—  Failed to start component with name </span><span class="token string" style="color:#e3116c">&quot;mysboproj&quot;</span><span class="token builtin class-name">.</span><span class="token plain"> Error: Failed to create the component: error </span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> waiting </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> deployment rollout: </span><span class="token function" style="color:#d73a49">timeout</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> waiting </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> mysboproj-app deployment roll out</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>In case this step fails due to a timeout, consider increasing the Build Timeout:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">odo preference </span><span class="token builtin class-name">set</span><span class="token plain"> BuildTimeout </span><span class="token number" style="color:#36acaa">600</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Deploy the application to the cluster again:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">odo push --show-log -f</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></li><li><p>The application is now deployed to the cluster - you can view the status of the cluster, and the application test results by streaming the cluster logs of the component that we pushed to the cluster in the previous step.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">odo log --follow</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p> Notice the failing tests due to an <code>UnknownDatabaseHostException</code>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">INFO</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">err</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> java.net.UnknownHostException: </span><span class="token variable" style="color:#36acaa">${DATABASE_CLUSTERIP}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">INFO</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">err</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">    at java.base/java.net.AbstractPlainSocketImpl.connect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">AbstractPlainSocketImpl.java:220</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">INFO</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">err</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">    at java.base/java.net.SocksSocketImpl.connect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">SocksSocketImpl.java:403</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">INFO</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">err</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">    at java.base/java.net.Socket.connect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Socket.java:609</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">INFO</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">err</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">    at org.postgresql.core.PGStream.</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">init</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">PGStream.java:68</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">INFO</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">err</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">    at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ConnectionFactoryImpl.java:144</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">INFO</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">err</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">. </span><span class="token number" style="color:#36acaa">86</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">more</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">ERROR</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Tests run: </span><span class="token number" style="color:#36acaa">2</span><span class="token plain">, Failures: </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">, Errors: </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">, Skipped: </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">, Time elapsed: </span><span class="token number" style="color:#36acaa">0.706</span><span class="token plain"> s </span><span class="token operator" style="color:#393A34">&lt;&lt;&lt;</span><span class="token plain"> FAILURE</span><span class="token operator" style="color:#393A34">!</span><span class="token plain"> - </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> org.example.app.it.DatabaseIT</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">ERROR</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> testGetAllPeople  Time elapsed: </span><span class="token number" style="color:#36acaa">0.33</span><span class="token plain"> s  </span><span class="token operator" style="color:#393A34">&lt;&lt;&lt;</span><span class="token plain"> FAILURE</span><span class="token operator" style="color:#393A34">!</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">org.opentest4j.AssertionFailedError: Expected at least </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> people to be registered, but there were only: </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> expected: </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">true</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> but was: </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">false</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">at org.example.app.it.DatabaseIT.testGetAllPeople</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">DatabaseIT.java:57</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">ERROR</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> testGetPerson  Time elapsed: </span><span class="token number" style="color:#36acaa">0.047</span><span class="token plain"> s  </span><span class="token operator" style="color:#393A34">&lt;&lt;&lt;</span><span class="token plain"> ERROR</span><span class="token operator" style="color:#393A34">!</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">java.lang.NullPointerException</span></div><div class="token-line" style="color:#393A34"><span class="token plain">at org.example.app.it.DatabaseIT.testGetPerson</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">DatabaseIT.java:41</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">INFO</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">INFO</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Results:</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">INFO</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">ERROR</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Failures:</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">ERROR</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">   DatabaseIT.testGetAllPeople:57 Expected at least </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> people to be registered, but there were only: </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> expected: </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">true</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> but was: </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">false</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">ERROR</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Errors:</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">ERROR</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">   DatabaseIT.testGetPerson:41 NullPointer</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">INFO</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">ERROR</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Tests run: </span><span class="token number" style="color:#36acaa">2</span><span class="token plain">, Failures: </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">, Errors: </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">, Skipped: </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">INFO</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">ERROR</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Integration tests failed: There are </span><span class="token builtin class-name">test</span><span class="token plain"> failures.</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Note: This error will be fixed at a later stage in the tutorial when we connect a database instance to this application.</p></li><li><p>You can also create a URL with <code>odo</code> to access the application:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">odo url create --host </span><span class="token variable" style="color:#36acaa">$(</span><span class="token variable" style="color:#36acaa">minikube </span><span class="token variable function" style="color:#d73a49">ip</span><span class="token variable" style="color:#36acaa">)</span><span class="token plain">.nip.io</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></li><li><p>Push the URL to activate it:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">odo push --show-log</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></li><li><p>Display the created URL:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">odo url list</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>You will see a fully formed URL that can be used in a web browser:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">$ odo url list</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Found the following URLs </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> component mysboproj</span></div><div class="token-line" style="color:#393A34"><span class="token plain">NAME               STATE      URL                                           PORT     SECURE     KIND</span></div><div class="token-line" style="color:#393A34"><span class="token plain">mysboproj-9080     Pushed     http://mysboproj-9080.192.168.49.2.nip.io     </span><span class="token number" style="color:#36acaa">9080</span><span class="token plain">     </span><span class="token boolean" style="color:#36acaa">false</span><span class="token plain">      ingress</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></li><li><p>Use the URL to navigate to the <code>CreatePerson.xhtml</code> data entry page to use the application:
In case of this tutorial, we will access <code>http://mysboproj-9080.192.168.49.2.nip.io/CreatePerson.xhtml</code>. Note that the URL could be different for you. Now, enter a name and age data using the form.</p></li><li><p>Click on the <strong>Save</strong> button when complete</p></li></ol><p>Note that the entry of any data does not result in the data being displayed when you click on the &quot;View Persons Record List&quot; link, until we connect the application to a database.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="creating-a-database-to-be-used-by-the-sample-application"></a>Creating a database to be used by the sample application<a class="hash-link" href="#creating-a-database-to-be-used-by-the-sample-application" title="Direct link to heading">#</a></h3><p>You can use the default configuration of the PostgreSQL Operator to start a Postgre database from it. But since our app uses few specific configuration values, lets make sure they are properly populated in the database service we start.</p><ol><li><p>Store the YAML of the service in a file:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">odo </span><span class="token function" style="color:#d73a49">service</span><span class="token plain"> create postgresql-operator.v0.1.1/Database --dry-run </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> db.yaml</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></li><li><p>Modify and add following values under <code>metadata:</code> section in the <code>db.yaml</code> file:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly yaml"><div tabindex="0" class="prism-code language-yaml codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> sampledatabase</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">annotations</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">service.binding/db_name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;path={.spec.databaseName}&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">service.binding/db_password</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;path={.spec.databasePassword}&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">service.binding/db_user</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;path={.spec.databaseUser}&#x27;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>This configuration ensures that when a database service is started using this file, appropriate annotations are added to it. Annotations help the Service Binding Operator in injecting those values into the application. Hence, the above configuration will help Service Binding Operator inject the values for <code>databaseName</code>, <code>databasePassword</code> and <code>databaseUser</code> into the application.</p></li><li><p>Change the following values under <code>spec:</code> section of the YAML file:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly yaml"><div tabindex="0" class="prism-code language-yaml codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">databaseName</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;sampledb&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">databasePassword</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;samplepwd&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">databaseUser</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;sampleuser&quot;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></li><li><p>Create the database from the YAML file:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">odo </span><span class="token function" style="color:#d73a49">service</span><span class="token plain"> create --from-file db.yaml</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain"> odo push --show-log</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p> This action will create a database instance pod in the <code>my-postgresql-operator-dev4devs-com</code> namespace. The application will be configured to use this database.</p></li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="binding-the-database-and-the-application"></a>Binding the database and the application<a class="hash-link" href="#binding-the-database-and-the-application" title="Direct link to heading">#</a></h3><p>Now, the only thing that remains is to connect the DB and the application. We will use odo to create a link to the PostgreSQL Database Operator in order to access the database connection information.</p><ol><li><p>List the service associated with the database created via the PostgreSQL Operator:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">odo </span><span class="token function" style="color:#d73a49">service</span><span class="token plain"> list</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Your output should look similar to the following:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">$ odo </span><span class="token function" style="color:#d73a49">service</span><span class="token plain"> list</span></div><div class="token-line" style="color:#393A34"><span class="token plain"> NAME                       MANAGED BY ODO     STATE     AGE</span></div><div class="token-line" style="color:#393A34"><span class="token plain"> Database/sampledatabase   Yes </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mysboproj</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">    Pushed    6m35s</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></li><li><p>Create a Service Binding Request between the application, and the database using the Service Binding Operator service created in the previous step:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">odo </span><span class="token function" style="color:#d73a49">link</span><span class="token plain"> Database/sampledatabase</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></li><li><p>Push this link to the cluster:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">odo push --show-log</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p> After the link has been created and pushed, a secret will have been created containing the database connection data that the application requires.</p><p> You can inspect the new intermediate secret via the dashboard console in the <code>my-postgresql-operator-dev4devs-com</code> namespace by navigating to Secrets and clicking on the secret named <code>mysboproj-database-sampledatabase</code>: notice that it contains 4 pieces of data that are related to the connection information for your PostgreSQL database instance.</p><p>Use <code>minikube dashboard</code> to launch the dashboard console.</p><p> Note: Pushing the newly created link will terminate the existing application pod and start a new application pod that mounts this secret.</p></li><li><p>Once the new pod has initialized, you can see the secret database connection data as it is injected into the pod environment by executing the following:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">odo </span><span class="token builtin class-name">exec</span><span class="token plain"> -- </span><span class="token function" style="color:#d73a49">bash</span><span class="token plain"> -c </span><span class="token string" style="color:#e3116c">&#x27;export | grep DATABASE&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">declare</span><span class="token plain"> -x </span><span class="token assign-left variable" style="color:#36acaa">DATABASE_CLUSTERIP</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;10.106.182.173&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">declare</span><span class="token plain"> -x </span><span class="token assign-left variable" style="color:#36acaa">DATABASE_DB_NAME</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;sampledb&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">declare</span><span class="token plain"> -x </span><span class="token assign-left variable" style="color:#36acaa">DATABASE_DB_PASSWORD</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;samplepwd&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">declare</span><span class="token plain"> -x </span><span class="token assign-left variable" style="color:#36acaa">DATABASE_DB_USER</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;sampleuser&quot;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Once the new version is up (there will be a slight delay until the application is available), navigate to the <code>CreatePerson.xhtml</code> using the URL created in a previous step. Enter the requested data and click the <strong>Save</strong> button.</p><p>Notice that you are re-directed to the <code>PersonList.xhtml</code> page, where your data is displayed having been input to the postgreSQL database and retrieved for display purposes.</p><p>You may inspect the database instance itself and query the table to see the data in place by using the postgreSQL command line tool, <code>psql</code>.</p></li><li><p>Navigate to the pod containing your db from the dashboard console. Use <code>minikube dashboard</code> to start the console.</p></li><li><p>Click on the terminal tab.</p></li><li><p>At the terminal prompt access <code>psql</code> for your database <code>sampledb</code>.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">psql sampledb</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Your output should look similar to the following:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">sh-4.2$ psql sampledb</span></div><div class="token-line" style="color:#393A34"><span class="token plain">psql </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">12.3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">Type </span><span class="token string" style="color:#e3116c">&quot;help&quot;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> help.</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">sampledb</span><span class="token operator" style="color:#393A34">=</span><span class="token comment" style="color:#999988;font-style:italic">#</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></li><li><p>Issue the following SQL statement from your :</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly postgresql"><div tabindex="0" class="prism-code language-postgresql codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">SELECT * FROM person;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></li><li><p>You can see the data that appeared in the results of the test run:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token assign-left variable" style="color:#36acaa">sampledb</span><span class="token operator" style="color:#393A34">=</span><span class="token comment" style="color:#999988;font-style:italic"># SELECT * FROM person;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">personid </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> age </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">  name   </span></div><div class="token-line" style="color:#393A34"><span class="token plain">----------+-----+---------</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">5</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">52</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> person1</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> row</span><span class="token punctuation" style="color:#393A34">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></li></ol></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/redhat-developer/odo/edit/main/website/docs/tutorials/deploying-java-app-with-database.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-label="Edit page"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/ododocs250/docs/command-reference/json-output"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« JSON Output</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/ododocs250/docs/tutorials/create-k8s-resources"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Creating Kubernetes resources using odo Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#cluster-admin" class="table-of-contents__link">Cluster admin</a><ul><li><a href="#prerequisites" class="table-of-contents__link">Prerequisites</a></li></ul></li><li><a href="#application-developer" class="table-of-contents__link">Application Developer</a><ul><li><a href="#prerequisites-1" class="table-of-contents__link">Prerequisites</a></li><li><a href="#importing-the-jpa-microservice" class="table-of-contents__link">Importing the JPA MicroService</a></li><li><a href="#creating-a-database-to-be-used-by-the-sample-application" class="table-of-contents__link">Creating a database to be used by the sample application</a></li><li><a href="#binding-the-database-and-the-application" class="table-of-contents__link">Binding the database and the application</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Learn</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/ododocs250/docs/getting-started/installation">Installation</a></li><li class="footer__item"><a class="footer__link-item" href="/ododocs250/docs/getting-started/quickstart">Quickstart</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://kubernetes.slack.com/archives/C01D6L2NUAG" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack</a></li><li class="footer__item"><a href="https://calendar.google.com/calendar/u/0/embed?src=gi0s0v5ukfqkjpnn26p6va3jfc@group.calendar.google.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Meetings</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/ododocs250/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/redhat-developer/odo" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li><li class="footer__item"><a href="https://twitter.com/rhdevelopers" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li></ul></div></div><div class="footer__bottom text--center"></div></div></footer></div>
<script src="/ododocs250/assets/js/runtime~main.bfc83875.js"></script>
<script src="/ododocs250/assets/js/main.0e928838.js"></script>
</body>
</html>