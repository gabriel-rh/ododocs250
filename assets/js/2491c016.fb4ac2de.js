"use strict";(self.webpackChunkodo_dev=self.webpackChunkodo_dev||[]).push([[2240],{3905:function(e,n,t){t.d(n,{Zo:function(){return d},kt:function(){return m}});var o=t(7294);function i(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function r(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){i(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,o,i=function(e,n){if(null==e)return{};var t,o,i={},a=Object.keys(e);for(o=0;o<a.length;o++)t=a[o],n.indexOf(t)>=0||(i[t]=e[t]);return i}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)t=a[o],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var l=o.createContext({}),p=function(e){var n=o.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):r(r({},n),e)),t},d=function(e){var n=p(e.components);return o.createElement(l.Provider,{value:n},e.children)},c={inlineCode:"code",wrapper:function(e){var n=e.children;return o.createElement(o.Fragment,{},n)}},u=o.forwardRef((function(e,n){var t=e.components,i=e.mdxType,a=e.originalType,l=e.parentName,d=s(e,["components","mdxType","originalType","parentName"]),u=p(t),m=i,h=u["".concat(l,".").concat(m)]||u[m]||c[m]||a;return t?o.createElement(h,r(r({ref:n},d),{},{components:t})):o.createElement(h,r({ref:n},d))}));function m(e,n){var t=arguments,i=n&&n.mdxType;if("string"==typeof e||i){var a=t.length,r=new Array(a);r[0]=u;var s={};for(var l in n)hasOwnProperty.call(n,l)&&(s[l]=n[l]);s.originalType=e,s.mdxType="string"==typeof e?e:i,r[1]=s;for(var p=2;p<a;p++)r[p]=t[p];return o.createElement.apply(null,r)}return o.createElement.apply(null,t)}u.displayName="MDXCreateElement"},5168:function(e,n,t){t.r(n),t.d(n,{frontMatter:function(){return s},metadata:function(){return l},toc:function(){return p},default:function(){return c}});var o=t(7462),i=t(3366),a=(t(7294),t(3905)),r=["components"],s={title:"odo link",sidebar_position:4},l={unversionedId:"command-reference/link",id:"command-reference/link",isDocsHomePage:!1,title:"odo link",description:"odo link command helps link an odo component to an Operator backed service or another odo component. It does this by using Service Binding Operator. At the time of writing this, odo makes use of the Service Binding library and not the Operator itself to achieve the desired functionality.",source:"@site/docs/command-reference/link.md",sourceDirName:"command-reference",slug:"/command-reference/link",permalink:"/docs/command-reference/link",editUrl:"https://github.com/redhat-developer/odo/edit/main/website/docs/command-reference/link.md",version:"current",sidebarPosition:4,frontMatter:{title:"odo link",sidebar_position:4},sidebar:"tutorialSidebar",previous:{title:"odo deploy",permalink:"/docs/command-reference/deploy"},next:{title:"odo registry",permalink:"/docs/command-reference/registry"}},p=[{value:"Various linking options",id:"various-linking-options",children:[{value:"Default behaviour",id:"default-behaviour",children:[]},{value:"The <code>--inlined</code> flag",id:"the---inlined-flag",children:[]},{value:"The <code>--map</code> flag",id:"the---map-flag",children:[]},{value:"The <code>--bind-as-files</code> flag",id:"the---bind-as-files-flag",children:[]}]},{value:"Examples",id:"examples",children:[{value:"Default <code>odo link</code>",id:"default-odo-link",children:[]},{value:"<code>odo link</code> with <code>--inlined</code>",id:"odo-link-with---inlined",children:[]},{value:"Custom bindings",id:"custom-bindings",children:[]}]},{value:"Binding as files",id:"binding-as-files",children:[]},{value:"<code>--bind-as-files</code> examples",id:"--bind-as-files-examples",children:[{value:"With default <code>odo link</code>",id:"with-default-odo-link",children:[]},{value:"With <code>--inlined</code>",id:"with---inlined",children:[]},{value:"Custom bindings",id:"custom-bindings-1",children:[]}]}],d={toc:p};function c(e){var n=e.components,t=(0,i.Z)(e,r);return(0,a.kt)("wrapper",(0,o.Z)({},d,t,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"odo link")," command helps link an odo component to an Operator backed service or another odo component. It does this by using ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/redhat-developer/service-binding-operator"},"Service Binding Operator"),". At the time of writing this, odo makes use of the Service Binding library and not the Operator itself to achieve the desired functionality."),(0,a.kt)("p",null,"In this document we will cover various options to create link between a component & a service, and a component & another component. The steps in this document are going to be based on the ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/dharmit/odo-quickstart/"},"odo quickstart project")," that we covered in ",(0,a.kt)("a",{parentName:"p",href:"/docs/getting-started/quickstart"},"Quickstart guide"),". The outputs mentioned in this document are based on commands executed on ",(0,a.kt)("a",{parentName:"p",href:"/docs/getting-started/cluster-setup/kubernetes"},"minikube cluster"),"."),(0,a.kt)("p",null,"This document assumes that you know how to ",(0,a.kt)("a",{parentName:"p",href:"/docs/command-reference/create"},"create components")," and ",(0,a.kt)("a",{parentName:"p",href:"/docs/command-reference/service"},"services"),". It also assumes that you have cloned the ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/dharmit/odo-quickstart/"},"odo quickstart project"),". Terminology used in this document:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("em",{parentName:"li"},"quickstart project"),": git clone of the odo quickstart project having below directory structure:",(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"$ tree -L 1\n.\n\u251c\u2500\u2500 backend\n\u251c\u2500\u2500 frontend\n\u251c\u2500\u2500 postgrescluster.yaml\n\u251c\u2500\u2500 quickstart.code-workspace\n\u2514\u2500\u2500 README.md\n\n2 directories, 3 files\n"))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("em",{parentName:"li"},"backend component"),": ",(0,a.kt)("inlineCode",{parentName:"li"},"backend")," directory in above tree structure"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("em",{parentName:"li"},"frontend component"),": ",(0,a.kt)("inlineCode",{parentName:"li"},"frontend")," directory in above tree structure"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("em",{parentName:"li"},"Postgres service"),": Operator backed service created from ",(0,a.kt)("em",{parentName:"li"},"backend component")," using the ",(0,a.kt)("inlineCode",{parentName:"li"},"odo service create --from-file ../postgrescluster.yaml")," command.")),(0,a.kt)("h2",{id:"various-linking-options"},"Various linking options"),(0,a.kt)("p",null,"odo provides various options to link a component with an Operator backed service or another odo component. All these options (or flags) can be used irrespective of whether you are linking a component to a service or another component."),(0,a.kt)("h3",{id:"default-behaviour"},"Default behaviour"),(0,a.kt)("p",null,"By default, ",(0,a.kt)("inlineCode",{parentName:"p"},"odo link")," creates a directory named ",(0,a.kt)("inlineCode",{parentName:"p"},"kubernetes/")," in your component directory and stores the information (YAML manifests) about services and links in it. When you do ",(0,a.kt)("inlineCode",{parentName:"p"},"odo push"),", odo compares these manifests with the state of the things on the Kubernetes cluster and decides whether it needs to create, modify or destroy resources to match what is specified by the user."),(0,a.kt)("h3",{id:"the---inlined-flag"},"The ",(0,a.kt)("inlineCode",{parentName:"h3"},"--inlined")," flag"),(0,a.kt)("p",null,"If you specified ",(0,a.kt)("inlineCode",{parentName:"p"},"--inlined")," flag to the ",(0,a.kt)("inlineCode",{parentName:"p"},"odo link")," command, odo will store the link information inline in the ",(0,a.kt)("inlineCode",{parentName:"p"},"devfile.yaml")," in the component directory instead of creating a file under ",(0,a.kt)("inlineCode",{parentName:"p"},"kubernetes/")," directory. The behaviour of ",(0,a.kt)("inlineCode",{parentName:"p"},"--inlined")," flag is similar in both the ",(0,a.kt)("inlineCode",{parentName:"p"},"odo link")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"odo service create")," commands. This flag is helpful if you would like everything to be stored in a single ",(0,a.kt)("inlineCode",{parentName:"p"},"devfile.yaml"),". You will have to remember to use ",(0,a.kt)("inlineCode",{parentName:"p"},"--inlined")," flag with each ",(0,a.kt)("inlineCode",{parentName:"p"},"odo link")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"odo service create")," commands that you execute for the component."),(0,a.kt)("h3",{id:"the---map-flag"},"The ",(0,a.kt)("inlineCode",{parentName:"h3"},"--map")," flag"),(0,a.kt)("p",null,"At times, you might want to add more binding information to the component than what is available by default. For example, if you are linking the component with a service and would like to bind some information from the service's spec (short for specification), you could use the ",(0,a.kt)("inlineCode",{parentName:"p"},"--map")," flag. Note that odo doesn't do any validation against the spec of the service/component being linked. Using this flag is recommended only if you are comfortable with reading the Kubernetes YAML manifests."),(0,a.kt)("h3",{id:"the---bind-as-files-flag"},"The ",(0,a.kt)("inlineCode",{parentName:"h3"},"--bind-as-files")," flag"),(0,a.kt)("p",null,"For all the linking options discussed so far, odo injects the binding information into the component as environment variables. If you would like to instead mount this information as files, you could use the ",(0,a.kt)("inlineCode",{parentName:"p"},"--bind-as-files")," flag. This will make odo inject the binding information as files into the ",(0,a.kt)("inlineCode",{parentName:"p"},"/bindings")," location within your component's Pod. Comparing with the environment variables paradigm, when you use ",(0,a.kt)("inlineCode",{parentName:"p"},"--bind-as-files"),", the files are named after the keys and the value of these keys is stored as the contents of these files."),(0,a.kt)("h2",{id:"examples"},"Examples"),(0,a.kt)("h3",{id:"default-odo-link"},"Default ",(0,a.kt)("inlineCode",{parentName:"h3"},"odo link")),(0,a.kt)("p",null,"We will link the backend component with the Postgres service using default ",(0,a.kt)("inlineCode",{parentName:"p"},"odo link")," command. For the backend component, make sure that your component and service are pushed to the cluster:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"$ odo list\nAPP     NAME        PROJECT       TYPE       STATE      MANAGED BY ODO\napp     backend     myproject     spring     Pushed     Yes\n\n\n$ odo service list\nNAME                      MANAGED BY ODO     STATE      AGE\nPostgresCluster/hippo     Yes (backend)      Pushed     59m41s\n\n")),(0,a.kt)("p",null,"Now, run ",(0,a.kt)("inlineCode",{parentName:"p"},"odo link")," to link the backend component with the Postgres service:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"odo link PostgresCluster/hippo\n")),(0,a.kt)("p",null,"Example output:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},'$ odo link PostgresCluster/hippo\n \u2713  Successfully created link between component "backend" and service "PostgresCluster/hippo"\n\nTo apply the link, please use `odo push`\n')),(0,a.kt)("p",null,"And then run ",(0,a.kt)("inlineCode",{parentName:"p"},"odo push")," for the link to actually get created on the Kubernetes cluster."),(0,a.kt)("p",null,"Upon successful ",(0,a.kt)("inlineCode",{parentName:"p"},"odo push"),", you can notice a few things:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"When you open the URL for the application deployed by backend component, it shows you a list of todo items in the database. For example, for below ",(0,a.kt)("inlineCode",{parentName:"p"},"odo url list")," output, we will append the path where todos are listed:"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"$ odo url list\nFound the following URLs for component backend\nNAME         STATE      URL                                       PORT     SECURE     KIND\n8080-tcp     Pushed     http://8080-tcp.192.168.39.112.nip.io     8080     false      ingress\n\n")),(0,a.kt)("p",{parentName:"li"},"The correct path for such URL would be - ",(0,a.kt)("a",{parentName:"p",href:"http://8080-tcp.192.168.39.112.nip.io/api/v1/todos"},"http://8080-tcp.192.168.39.112.nip.io/api/v1/todos"),". Note that exact URL would be different for your setup. Also note that there are no todos in the database unless you add some, so the URL might just show an empty JSON object.")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"You can see binding information related to Postgres service injected into the backend component. This binding information is injected, by default, as environment variables. You can check it out using the ",(0,a.kt)("inlineCode",{parentName:"p"},"odo describe")," command from backend component's directory:"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"odo describe \n")),(0,a.kt)("p",{parentName:"li"},"Example output:"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"$ odo describe\nComponent Name: backend\nType: spring\nEnvironment Variables:\n \xb7 PROJECTS_ROOT=/projects\n \xb7 PROJECT_SOURCE=/projects\n \xb7 DEBUG_PORT=5858\nStorage:\n \xb7 m2 of size 3Gi mounted to /home/user/.m2\nURLs:\n \xb7 http://8080-tcp.192.168.39.112.nip.io exposed via 8080\nLinked Services:\n \xb7 PostgresCluster/hippo\n   Environment Variables:\n    \xb7 POSTGRESCLUSTER_PGBOUNCER-EMPTY\n    \xb7 POSTGRESCLUSTER_PGBOUNCER.INI\n    \xb7 POSTGRESCLUSTER_ROOT.CRT\n    \xb7 POSTGRESCLUSTER_VERIFIER\n    \xb7 POSTGRESCLUSTER_ID_ECDSA\n    \xb7 POSTGRESCLUSTER_PGBOUNCER-VERIFIER\n    \xb7 POSTGRESCLUSTER_TLS.CRT\n    \xb7 POSTGRESCLUSTER_PGBOUNCER-URI\n    \xb7 POSTGRESCLUSTER_PATRONI.CRT-COMBINED\n    \xb7 POSTGRESCLUSTER_USER\n    \xb7 pgImage\n    \xb7 pgVersion\n    \xb7 POSTGRESCLUSTER_CLUSTERIP\n    \xb7 POSTGRESCLUSTER_HOST\n    \xb7 POSTGRESCLUSTER_PGBACKREST_REPO.CONF\n    \xb7 POSTGRESCLUSTER_PGBOUNCER-USERS.TXT\n    \xb7 POSTGRESCLUSTER_SSH_CONFIG\n    \xb7 POSTGRESCLUSTER_TLS.KEY\n    \xb7 POSTGRESCLUSTER_CONFIG-HASH\n    \xb7 POSTGRESCLUSTER_PASSWORD\n    \xb7 POSTGRESCLUSTER_PATRONI.CA-ROOTS\n    \xb7 POSTGRESCLUSTER_DBNAME\n    \xb7 POSTGRESCLUSTER_PGBOUNCER-PASSWORD\n    \xb7 POSTGRESCLUSTER_SSHD_CONFIG\n    \xb7 POSTGRESCLUSTER_PGBOUNCER-FRONTEND.KEY\n    \xb7 POSTGRESCLUSTER_PGBACKREST_INSTANCE.CONF\n    \xb7 POSTGRESCLUSTER_PGBOUNCER-FRONTEND.CA-ROOTS\n    \xb7 POSTGRESCLUSTER_PGBOUNCER-HOST\n    \xb7 POSTGRESCLUSTER_PORT\n    \xb7 POSTGRESCLUSTER_ROOT.KEY\n    \xb7 POSTGRESCLUSTER_SSH_KNOWN_HOSTS\n    \xb7 POSTGRESCLUSTER_URI\n    \xb7 POSTGRESCLUSTER_PATRONI.YAML\n    \xb7 POSTGRESCLUSTER_DNS.CRT\n    \xb7 POSTGRESCLUSTER_DNS.KEY\n    \xb7 POSTGRESCLUSTER_ID_ECDSA.PUB\n    \xb7 POSTGRESCLUSTER_PGBOUNCER-FRONTEND.CRT\n    \xb7 POSTGRESCLUSTER_PGBOUNCER-PORT\n    \xb7 POSTGRESCLUSTER_CA.CRT\n")),(0,a.kt)("p",{parentName:"li"},"Few of these variables are used in the backend component's ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/dharmit/odo-quickstart/blob/main/backend/src/main/resources/application.properties"},(0,a.kt)("inlineCode",{parentName:"a"},"src/main/resources/application.properties")," file")," so that the Java Springboot application can connect to the Postgres database service.")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Lastly, odo has created a directory called ",(0,a.kt)("inlineCode",{parentName:"p"},"kubernetes/")," in your backend component's directory which contains below files. "),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"$ ls kubernetes \nodo-service-backend-postgrescluster-hippo.yaml  odo-service-hippo.yaml\n")),(0,a.kt)("p",{parentName:"li"},"This files contains the information (YAML manifests) about two things:"),(0,a.kt)("ol",{parentName:"li"},(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("inlineCode",{parentName:"li"},"odo-service-hippo.yaml")," - the Postgres service we created using ",(0,a.kt)("inlineCode",{parentName:"li"},"odo service create --from-file ../postgrescluster.yaml")," command."),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("inlineCode",{parentName:"li"},"odo-service-backend-postgrescluster-hippo.yaml")," - the link we created using ",(0,a.kt)("inlineCode",{parentName:"li"},"odo link")," command.")))),(0,a.kt)("h3",{id:"odo-link-with---inlined"},(0,a.kt)("inlineCode",{parentName:"h3"},"odo link")," with ",(0,a.kt)("inlineCode",{parentName:"h3"},"--inlined")),(0,a.kt)("p",null,"Using ",(0,a.kt)("inlineCode",{parentName:"p"},"--inlined")," flag with ",(0,a.kt)("inlineCode",{parentName:"p"},"odo link")," command does the exact same thing to our application (that is, injects binding information) as an ",(0,a.kt)("inlineCode",{parentName:"p"},"odo link")," command without the flag does. However, the subtle difference is that in above case we saw two manifest files under ",(0,a.kt)("inlineCode",{parentName:"p"},"kubernetes/")," directory \u2014 one for the Postgres service and other for the link between the backend component and this service \u2014 but when we pass ",(0,a.kt)("inlineCode",{parentName:"p"},"--inlined")," flag, odo does not create a file under ",(0,a.kt)("inlineCode",{parentName:"p"},"kubernetes/")," directory to store the YAML manifest, but stores it inline in the ",(0,a.kt)("inlineCode",{parentName:"p"},"devfile.yaml")," file."),(0,a.kt)("p",null,"To see this, let's unlink our component from the Postgres service first:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"odo unlink PostgresCluster/hippo\n")),(0,a.kt)("p",null,"Example output:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},'$ odo unlink PostgresCluster/hippo\n \u2713  Successfully unlinked component "backend" from service "PostgresCluster/hippo"\n\nTo apply the changes, please use `odo push`\n')),(0,a.kt)("p",null,"To unlink them on the cluster, run ",(0,a.kt)("inlineCode",{parentName:"p"},"odo push"),". Now if you take a look at the ",(0,a.kt)("inlineCode",{parentName:"p"},"kubernetes/")," directory, you'll see only one file in it:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"$ ls kubernetes \nodo-service-hippo.yaml\n")),(0,a.kt)("p",null,"Next, let's use the ",(0,a.kt)("inlineCode",{parentName:"p"},"--inlined")," flag to create a link:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"odo link PostgresCluster/hippo --inlined\n")),(0,a.kt)("p",null,"Example output:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},'$ odo link PostgresCluster/hippo --inlined\n \u2713  Successfully created link between component "backend" and service "PostgresCluster/hippo"\n\nTo apply the link, please use `odo push`\n')),(0,a.kt)("p",null,"Just like the time without ",(0,a.kt)("inlineCode",{parentName:"p"},"--inlined")," flag, you need to do ",(0,a.kt)("inlineCode",{parentName:"p"},"odo push")," for the link to get created on the cluster. But where did odo store the configuration/manifest required to create this link? odo stores this in ",(0,a.kt)("inlineCode",{parentName:"p"},"devfile.yaml"),". You can see an entry like below in this file:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yaml"},' kubernetes:\n    inlined: |\n      apiVersion: binding.operators.coreos.com/v1alpha1\n      kind: ServiceBinding\n      metadata:\n        creationTimestamp: null\n        name: backend-postgrescluster-hippo\n      spec:\n        application:\n          group: apps\n          name: backend-app\n          resource: deployments\n          version: v1\n        bindAsFiles: false\n        detectBindingResources: true\n        services:\n        - group: postgres-operator.crunchydata.com\n          id: hippo\n          kind: PostgresCluster\n          name: hippo\n          version: v1beta1\n      status:\n        secret: ""\n  name: backend-postgrescluster-hippo\n')),(0,a.kt)("p",null,"Now if you were to do ",(0,a.kt)("inlineCode",{parentName:"p"},"odo unlink PostgresCluster/hippo"),", odo would first remove the link information from the ",(0,a.kt)("inlineCode",{parentName:"p"},"devfile.yaml")," and then a subsequent ",(0,a.kt)("inlineCode",{parentName:"p"},"odo push")," would delete the link from the cluster."),(0,a.kt)("h3",{id:"custom-bindings"},"Custom bindings"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"odo link")," accepts the flag ",(0,a.kt)("inlineCode",{parentName:"p"},"--map")," which can inject custom binding information into the component. Such binding information will be fetched from the manifest of the resource we are linking to our component. For example, speaking in context of the backend component and Postgres service, we can inject information from the Postgres service's manifest (",(0,a.kt)("a",{parentName:"p",href:"https://github.com/dharmit/odo-quickstart/blob/main/postgrescluster.yaml"},(0,a.kt)("inlineCode",{parentName:"a"},"postgrescluster.yaml")," file"),") into the backend component."),(0,a.kt)("p",null,"Considering the name of your ",(0,a.kt)("inlineCode",{parentName:"p"},"PostgresCluster")," service is ",(0,a.kt)("inlineCode",{parentName:"p"},"hippo")," (check the output of ",(0,a.kt)("inlineCode",{parentName:"p"},"odo service list")," if your PostgresCluster service is named differently), if we wanted to inject the value of ",(0,a.kt)("inlineCode",{parentName:"p"},"postgresVersion")," from that YAML definition into our backend component:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"odo link PostgresCluster/hippo --map pgVersion='{{ .hippo.spec.postgresVersion }}'\n")),(0,a.kt)("p",null,"Note that, if the name of your Postgres service is different from ",(0,a.kt)("inlineCode",{parentName:"p"},"hippo"),", you will have to specify that in the above command in place ",(0,a.kt)("inlineCode",{parentName:"p"},".hippo"),". For example, if your ",(0,a.kt)("inlineCode",{parentName:"p"},"PostgresCluster")," service is named as ",(0,a.kt)("inlineCode",{parentName:"p"},"database"),", you would change the link command to as shown below:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"$ odo service list\nNAME                      MANAGED BY ODO     STATE      AGE\nPostgresCluster/database     Yes (backend)      Pushed     2h5m43s\n\n$ odo link PostgresCluster/hippo --map pgVersion='{{ .database.spec.postgresVersion }}'\n")),(0,a.kt)("p",null,"After a link operation, do ",(0,a.kt)("inlineCode",{parentName:"p"},"odo push")," as usual. Upon successful completion of push operation, you can run below command from your backend component directory to validate if custom mapping got injected properly:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"odo exec -- env | grep pgVersion\n")),(0,a.kt)("p",null,"Example output:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"$ odo exec -- env | grep pgVersion\npgVersion=13\n")),(0,a.kt)("p",null,"Since a user might want to inject more than just one piece of custom binding information, ",(0,a.kt)("inlineCode",{parentName:"p"},"odo link")," accepts multiple key-value pairs of mappings. The only constraint being that these should be specified as ",(0,a.kt)("inlineCode",{parentName:"p"},"--map <key>=<value>"),". For example, if you want to also inject Postgres image information along with the version, you could do:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"odo link PostgresCluster/hippo --map pgVersion='{{ .hippo.spec.postgresVersion }}' --map pgImage='{{ .hippo.spec.image }}'\n")),(0,a.kt)("p",null,"and do ",(0,a.kt)("inlineCode",{parentName:"p"},"odo push"),". The way to validate if both the mappings got injected correctly would be to do:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},'odo exec -- env | grep -e "pgVersion\\|pgImage"\n')),(0,a.kt)("p",null,"Example output:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},'$ odo exec -- env | grep -e "pgVersion\\|pgImage"\npgVersion=13\npgImage=registry.developers.crunchydata.com/crunchydata/crunchy-postgres-ha:centos8-13.4-0\n\n')),(0,a.kt)("h4",{id:"to-inline-or-not"},"To inline or not?"),(0,a.kt)("p",null,"You can stick to the default behaviour wherein ",(0,a.kt)("inlineCode",{parentName:"p"},"odo link")," will generate a manifest file for the link under ",(0,a.kt)("inlineCode",{parentName:"p"},"kubernetes/")," directory, or you could use ",(0,a.kt)("inlineCode",{parentName:"p"},"--inlined")," flag if you prefer to store everything in a single ",(0,a.kt)("inlineCode",{parentName:"p"},"devfile.yaml")," file. It doesn't matter what you use for this functionality of adding custom mappings."),(0,a.kt)("h2",{id:"binding-as-files"},"Binding as files"),(0,a.kt)("p",null,"Another helpful flag that ",(0,a.kt)("inlineCode",{parentName:"p"},"odo link")," provides is called ",(0,a.kt)("inlineCode",{parentName:"p"},"--bind-as-files"),". When this flag is passed, the binding information is not injected into the component's Pod as environment variables but is mounted as a filesystem. We will see a few examples that will make things clearer."),(0,a.kt)("p",null,"Ensure that there are no existing links between the backend component and the Postgres service. You could do this by running ",(0,a.kt)("inlineCode",{parentName:"p"},"odo describe")," in the backend component's directory and check if you see something like below in the output:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"Linked Services:\n \xb7 PostgresCluster/hippo\n")),(0,a.kt)("p",null,"Unlink the service from the component using:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"odo unlink PostgresCluster/hippo\nodo push\n")),(0,a.kt)("h2",{id:"--bind-as-files-examples"},(0,a.kt)("inlineCode",{parentName:"h2"},"--bind-as-files")," examples"),(0,a.kt)("h3",{id:"with-default-odo-link"},"With default ",(0,a.kt)("inlineCode",{parentName:"h3"},"odo link")),(0,a.kt)("p",null,"Default behaviour means odo creating the manifest file under ",(0,a.kt)("inlineCode",{parentName:"p"},"kubernetes/")," directory to store the link information. Link the backend component and Postgres service using:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"odo link PostgresCluster/hippo --bind-as-files\nodo push\n")),(0,a.kt)("p",null,"Example ",(0,a.kt)("inlineCode",{parentName:"p"},"odo describe")," output:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"$ odo describe\nComponent Name: backend\nType: spring\nEnvironment Variables:\n \xb7 PROJECTS_ROOT=/projects\n \xb7 PROJECT_SOURCE=/projects\n \xb7 DEBUG_PORT=5858\n \xb7 SERVICE_BINDING_ROOT=/bindings\n \xb7 SERVICE_BINDING_ROOT=/bindings\nStorage:\n \xb7 m2 of size 3Gi mounted to /home/user/.m2\nURLs:\n \xb7 http://8080-tcp.192.168.39.112.nip.io exposed via 8080\nLinked Services:\n \xb7 PostgresCluster/hippo\n   Files:\n    \xb7 /bindings/backend-postgrescluster-hippo/pgbackrest_instance.conf\n    \xb7 /bindings/backend-postgrescluster-hippo/user\n    \xb7 /bindings/backend-postgrescluster-hippo/ssh_known_hosts\n    \xb7 /bindings/backend-postgrescluster-hippo/clusterIP\n    \xb7 /bindings/backend-postgrescluster-hippo/password\n    \xb7 /bindings/backend-postgrescluster-hippo/patroni.yaml\n    \xb7 /bindings/backend-postgrescluster-hippo/pgbouncer-frontend.crt\n    \xb7 /bindings/backend-postgrescluster-hippo/pgbouncer-host\n    \xb7 /bindings/backend-postgrescluster-hippo/root.key\n    \xb7 /bindings/backend-postgrescluster-hippo/pgbouncer-frontend.key\n    \xb7 /bindings/backend-postgrescluster-hippo/pgbouncer.ini\n    \xb7 /bindings/backend-postgrescluster-hippo/uri\n    \xb7 /bindings/backend-postgrescluster-hippo/config-hash\n    \xb7 /bindings/backend-postgrescluster-hippo/pgbouncer-empty\n    \xb7 /bindings/backend-postgrescluster-hippo/port\n    \xb7 /bindings/backend-postgrescluster-hippo/dns.crt\n    \xb7 /bindings/backend-postgrescluster-hippo/pgbouncer-uri\n    \xb7 /bindings/backend-postgrescluster-hippo/root.crt\n    \xb7 /bindings/backend-postgrescluster-hippo/ssh_config\n    \xb7 /bindings/backend-postgrescluster-hippo/dns.key\n    \xb7 /bindings/backend-postgrescluster-hippo/host\n    \xb7 /bindings/backend-postgrescluster-hippo/patroni.crt-combined\n    \xb7 /bindings/backend-postgrescluster-hippo/pgbouncer-frontend.ca-roots\n    \xb7 /bindings/backend-postgrescluster-hippo/tls.key\n    \xb7 /bindings/backend-postgrescluster-hippo/verifier\n    \xb7 /bindings/backend-postgrescluster-hippo/ca.crt\n    \xb7 /bindings/backend-postgrescluster-hippo/dbname\n    \xb7 /bindings/backend-postgrescluster-hippo/patroni.ca-roots\n    \xb7 /bindings/backend-postgrescluster-hippo/pgbackrest_repo.conf\n    \xb7 /bindings/backend-postgrescluster-hippo/pgbouncer-port\n    \xb7 /bindings/backend-postgrescluster-hippo/pgbouncer-verifier\n    \xb7 /bindings/backend-postgrescluster-hippo/id_ecdsa\n    \xb7 /bindings/backend-postgrescluster-hippo/id_ecdsa.pub\n    \xb7 /bindings/backend-postgrescluster-hippo/pgbouncer-password\n    \xb7 /bindings/backend-postgrescluster-hippo/pgbouncer-users.txt\n    \xb7 /bindings/backend-postgrescluster-hippo/sshd_config\n    \xb7 /bindings/backend-postgrescluster-hippo/tls.crt\n")),(0,a.kt)("p",null,"Everything that was an environment variable in the ",(0,a.kt)("inlineCode",{parentName:"p"},"key=value")," format in the earlier ",(0,a.kt)("inlineCode",{parentName:"p"},"odo describe")," output is now mounted as file. Let's we ",(0,a.kt)("inlineCode",{parentName:"p"},"cat")," the contents of few of these files:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"$ odo exec -- cat /bindings/backend-postgrescluster-hippo/password\nq({JC:jn^mm/Bw}eu+j.GX{k\n\n$ odo exec -- cat /bindings/backend-postgrescluster-hippo/user    \nhippo\n\n$ odo exec -- cat /bindings/backend-postgrescluster-hippo/clusterIP\n10.101.78.56\n")),(0,a.kt)("h3",{id:"with---inlined"},"With ",(0,a.kt)("inlineCode",{parentName:"h3"},"--inlined")),(0,a.kt)("p",null,"The result of using ",(0,a.kt)("inlineCode",{parentName:"p"},"--bind-as-files")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"--inlined")," together is similar to ",(0,a.kt)("inlineCode",{parentName:"p"},"odo link --inlined"),", in that, the manifest of the link gets stored in the ",(0,a.kt)("inlineCode",{parentName:"p"},"devfile.yaml")," instead of being stored in a separate file under ",(0,a.kt)("inlineCode",{parentName:"p"},"kubernetes/")," directory. Other than that, the ",(0,a.kt)("inlineCode",{parentName:"p"},"odo describe")," output would like same as saw in the ",(0,a.kt)("a",{parentName:"p",href:"#with-default-odo-link"},"above section"),"."),(0,a.kt)("h3",{id:"custom-bindings-1"},"Custom bindings"),(0,a.kt)("p",null,"When you pass custom bindings while linking the backend component with the Postgres service, these custom bindings are injected not as environment variables but mounted as files. Consider below example:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"odo link PostgresCluster/hippo --map pgVersion='{{ .hippo.spec.postgresVersion }}' --map pgImage='{{ .hippo.spec.image }}' --bind-as-files\nodo push\n")),(0,a.kt)("p",null,"These custom bindings got mounted as files instead of being injected as environment variables. The way to validate if that worked would be:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"$ odo exec -- cat /bindings/backend-postgrescluster-hippo/pgVersion\n13\n\n$ odo exec -- cat /bindings/backend-postgrescluster-hippo/pgImage  \nregistry.developers.crunchydata.com/crunchydata/crunchy-postgres-ha:centos8-13.4-0\n")))}c.isMDXComponent=!0}}]);